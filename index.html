<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="max-age=3600, public">
    <meta http-equiv="Expires" content="Wed, 21 Oct 2025 07:28:00 GMT">
    <title>2025 Calendar & Messages</title>
    <link rel="stylesheet" href="style_index.css">
    <script>
        // 检查用户是否已登录
        if (!localStorage.getItem('loggedIn')) {
            window.location.href = 'login.html'; // 未登录时跳转到登录页面
        }
    </script>
</head>
<body>
    <div id="stars"></div>
    <script src="star.js"></script>
    <header class="header">
        <div class="header-content">
            <h1 class="header-title" id="randomQuote">欢迎来到我们的主页</h1>
            <!-- <button id="themeToggle" class="theme-toggle">切换主题</button>
            <script src="theme.js"></script> -->
            <div class="info-icon" onclick="showInfo()">
                ℹ
            </div>
            <script>
                function showInfo() {
                    alert("使用电脑或平板浏览页面效果最佳，手机推荐横屏浏览。\n如果遇到内容或媒体加载较慢或加载不出来的情形，请尝试打开梯子。\n遇到任何问题无法解决时，请尝试与大木头联系😊");
                }
            </script>
            <button onclick="logout()" class="logout-button">退出登录</button>
        </div>
    </header>
    <script>
        function logout() {
            localStorage.removeItem('loggedIn'); // 移除登录状态
            window.location.href = 'login.html'; // 跳转到登录页面
        }
                // 爱情名人名言列表
        const loveQuotes = [
            "“爱是长久忍耐，又有恩慈。” — 圣经《哥林多前书》",
            "“真正的爱情是吸引，而不是束缚。” — 马克·吐温",
            "“你若爱她，让你的爱像阳光一样包围她，并且给她自由。” — 泰戈尔",
            "“爱是生命的盐，它使生活有滋有味。” — 列夫·托尔斯泰",
            "“爱情是友谊的升华，是真心的付出和不求回报的关怀。” — 林语堂",
            "“爱是理解的别名。” — 泰戈尔",
            "“爱情让人成为更好的自己。” — 奥斯卡·王尔德",
            "“爱比伟大更伟大。” — 雪莱",
            "“当爱触碰到心灵时，它便不再是肉体的羁绊，而是灵魂的共鸣。” — 埃克哈特·托利",
            "“你是我最深的渴望，也是我最甜的牵挂。” — 未知",
            "“爱情是两个灵魂在同一个思想中的相遇。” — 纪伯伦",
            "“爱是无条件的，它不求回报。” — 玛丽·安·拉德马赫",
            "“爱是生活的火焰，没有它，一切变得黑暗。” — 罗曼·罗兰",
            "“爱是永恒的，外表可能改变，但本质永远不变。” — 文森特·梵高",
            "“爱是灵魂的相遇，是心灵的共鸣。” — 约翰·济慈",
            "“爱是唯一的现实，是我们存在的最终意义。” — 亨利·米勒",
            "“爱是我们对彼此的承诺，是我们共同的信仰。” — 未知",
            "“爱是我们生命中的光芒，是我们前行的动力。” — 未知",
        ];

        // 随机选择名言并插入到页面
        function displayRandomQuote() {
            const randomIndex = Math.floor(Math.random() * loveQuotes.length);
            const randomQuote = loveQuotes[randomIndex];
            document.getElementById('randomQuote').textContent = randomQuote;
        }

        // 调用函数在页面加载时更新标题
        window.onload = displayRandomQuote;
    </script>

    <audio id="backgroundMusic" loop>
        <source src="audio/Minecrafts_end.mp3" type="audio/mpeg">
        您的浏览器不支持音频播放。
    </audio>

    <script>
        function toggleMusic() {
            const audio = document.getElementById('backgroundMusic');
            const button = document.getElementById('playPauseButton');
            if (audio.paused) {
                audio.play();
                button.textContent = "⏸️";
            } else {
                audio.pause();
                button.textContent = "▶️";
            }
        }
    </script>

    <div class="intro">
        <h2>
            <span class="vertical-title">雅雅</span>
            &emsp;&emsp;&emsp;&emsp;，欢迎来到我们的小天地——eureka-ya.xin
            <button onclick="toggleMusic()" id="playPauseButton" style="border: none; background: none; cursor: pointer; font-size: 24px; margin-left: 10px;">
                ▶️
            </button>
        </h2>
            <p>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;欢迎来到这个永恒的数字领域，这是一片属于我们的精神家园，托管在一个由大木头精心挑选的专属域名之上。就像《Minecraft's End》这首歌中描述的《我的世界》中那无尽的宇宙终点一样，这个域名象征着无穷无尽的可能性，它不仅仅是几百行的代码，更是一座连接彼此心灵的桥梁。每当你轻轻点击，便是一次穿越虚拟与真实的旅程。</p>
            <p>域名，如同宇宙中的一颗恒星，指引我们在信息的荒原中找到彼此。这片空间不仅承载了我们共同的回忆，更见证着每一次温暖的交谈、每一段值得铭记的故事。它超越了时间与空间的界限，化作专属于我们的符号，铭刻在这浩瀚的互联网星图中。</p>
            <p>雅雅，这不是普通的礼物，而是我赋予你的专属特权。正如歌词所言，“I see the player you mean...” 你是这个故事中的主角，而我愿做那轻声低语的叙述者，为你筑造一个充满爱的世界。在这里，每一个页面都是我们感情的片段，每一次点击都是一次全新的旅程。无论未来如何变化，这里都会是我们最安稳的归所。</p>
    </div>

    <div class="photo-wall">
        <div class="scrolling-photos">
            <img src="images/index/001.webp" alt="Photo 1">
            <img src="images/index/002.webp" alt="Photo 2">
            <img src="images/index/003.webp" alt="Photo 3">
            <img src="images/index/004.webp" alt="Photo 4">
            <img src="images/index/005.webp" alt="Photo 5">
            <img src="images/index/006.webp" alt="Photo 6">
            <img src="images/index/007.webp" alt="Photo 7">
            <img src="images/index/008.webp" alt="Photo 8">
            <img src="images/index/009.webp" alt="Photo 9">
            <img src="images/index/010.webp" alt="Photo 10">
            <img src="images/index/011.webp" alt="Photo 11">
            <img src="images/index/012.webp" alt="Photo 12">
            <img src="images/index/013.webp" alt="Photo 13">
            <img src="images/index/014.webp" alt="Photo 14">
            <img src="images/index/015.webp" alt="Photo 15">
            <img src="images/index/016.webp" alt="Photo 16">
            <img src="images/index/017.webp" alt="Photo 17">
        </div>
        <div class="center-image">
            <img src="images/index/certificate.JPG" alt="Center Image">
        </div>
    </div>

    <div class="content">
        <h1>2025 Calendar & Messages <br> ——also a love letter</h1>
        <div class="time-weather-section">
            <div class="city-info">
                <h3>西安（十号楼）</h3>
                <p>时间：<span id="beijingTime"></span></p>
                <p><span id="xian-weather">加载中...</span></p>
            </div>
            <div class="city-info">
                <h3>伯克利（大木头公寓）</h3>
                <p>时间：<span id="pacificTime"></span></p>
                <p><span id="berkeley-weather">加载中...</span></p>
            </div>
        </div>
        <script src="weather.js"></script>
        <script>
            function updateTime() {
                const beijingTime = new Date().toLocaleString("zh-CN", { timeZone: "Asia/Shanghai", hour12: false });
                const pacificTime = new Date().toLocaleString("en-US", { timeZone: "America/Los_Angeles", hour12: false });

                document.getElementById('beijingTime').textContent = beijingTime;
                document.getElementById('pacificTime').textContent = pacificTime;
            }

            setInterval(updateTime, 1000); // 每秒更新一次时间
            updateTime(); // 初始化时立即调用一次
        </script>

 
        <p style="font-size: 18px; font-weight: bold; color: #333;">点击今天的日期，开启你和大木头的幸运旅程:</p>

        <div class="calendar-container">
            <div class="month-selector">
                <select id="monthSelect" onchange="updateCalendar()">
                    <option value="0">1月份</option>
                    <option value="1">2月份</option>
                    <option value="2">3月份</option>
                    <option value="3">4月份</option>
                    <option value="4">5月份</option>
                    <option value="5">6月份</option>
                    <option value="6">7月份</option>
                    <option value="7">8月份</option>
                    <option value="8">9月份</option>
                    <option value="9">10月份</option>
                    <option value="10">11月份</option>
                    <option value="11">12月份</option>
                </select>
            </div>
            <div class="calendar-countdown">
                <table class="calendar">
                    <thead>
                        <tr>
                            <th>Sun</th>
                            <th>Mon</th>
                            <th>Tue</th>
                            <th>Wed</th>
                            <th>Thu</th>
                            <th>Fri</th>
                            <th>Sat</th>
                        </tr>
                    </thead>
                    <tbody id="calendarBody">
                        <!-- 日历内容由 JavaScript 动态填充 -->
                    </tbody>
                </table>
                <div class="countdown-container">
                    <p>离大木头回国还有</p>
                    <p id="countdownDays" class="countdown-days">加载中...</p>
                    <p>天</p>
                </div>
                <script src="countdown.js"></script>
            </div>
        </div>
        <div>
            <a href="letter.html" class="calendar-link">Letter</a>
            <a href="special.html" class="calendar-link" data-locked="true" onclick="checkLock(event)">Left for Special Day</a>
        </div>
        <script>
            function checkLock(event) {
                const locked = event.target.dataset.locked;
                if (locked) {
                    event.preventDefault();
                    alert('这是一个特别的日子，需要解锁后才能查看！');
                }
            }
        </script>
    </div>

    <script>
        const holidays = {
            // 国内节日
            "2025-01-01": "元旦",
            "2025-01-28": "除夕", // 农历除夕
            "2025-01-29": "春节", // 农历正月初一
            "2025-02-12": "元宵节", // 农历正月十五
            "2025-04-04": "清明节",
            "2025-05-01": "劳动节",
            "2025-05-31": "端午节", // 农历五月初五
            "2025-08-29": "七夕节", // 农历七月初七
            "2025-10-06": "中秋节", // 农历八月十五
            "2025-10-01": "国庆节",
            "2025-10-29": "重阳节", // 农历九月初九

            // 国际节日
            "2025-02-14": "情人节",
            "2025-03-08": "国际妇女节",
            "2025-03-15": "消费者权益日",
            "2025-04-22": "世界地球日",
            "2025-05-11": "母亲节", // 每年5月的第二个星期日
            "2025-06-15": "父亲节", // 每年6月的第三个星期日
            "2025-06-05": "世界环境日",
            "2025-10-31": "万圣节",
            "2025-11-27": "感恩节", // 每年11月的第四个星期四
            "2025-12-25": "圣诞节",
            "2025-11-11": "光棍节",

            // 美国节日
            "2025-01-20": "马丁路德金纪念日", // 每年1月的第三个星期一
            "2025-02-17": "总统日", // 每年2月的第三个星期一
            "2025-03-24": "春假", // 动态日期，根据学校决定
            "2025-03-25": "春假",
            "2025-03-26": "春假",
            "2025-03-27": "春假",
            "2025-07-04": "美国独立日",
            "2025-09-01": "劳动节（美国）", // 每年9月的第一个星期一
            "2025-10-13": "哥伦布日", // 每年10月的第二个星期一
            "2025-11-28": "黑色星期五", // 感恩节后的星期五
            "2025-06-19": "六月节", // 纪念废除奴隶制
            "2025-12-31": "跨年夜", // 新年前夜

            // 个人节日
            "2025-01-13": "大木头出发✈️",
            "2025-03-27": "大木头生日🎂",
            "2025-04-01": "愚人节",
            "2025-05-12": "期末周",
            "2025-05-13": "期末周",
            "2025-05-14": "期末周",
            "2025-05-15": "期末周",
            "2025-05-16": "期末周",
            "2025-05-20": "我爱你❤️",
            "2025-08-22": "雅雅生日🎂"
        };
        function generateCalendar(year, month) {
            const calendarBody = document.getElementById('calendarBody');
            calendarBody.innerHTML = '';

            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();

            let date = 1;
            for (let i = 0; i < 6; i++) {
                const row = document.createElement('tr');
                for (let j = 0; j < 7; j++) {
                    const cell = document.createElement('td');
                    if (i === 0 && j < firstDay) {
                        row.appendChild(cell);
                    } else if (date > daysInMonth) {
                        break;
                    } else {
                        const currentDate = `${year}-${String(month + 1).padStart(2, '0')}-${String(date).padStart(2, '0')}`;
                        const link = document.createElement('a');
                        link.href = `pages/2025-${String(month + 1).padStart(2, '0')}-${String(date).padStart(2, '0')}.html`;
                        link.textContent = date;

                        // 检查是否为节假日
                        if (holidays[currentDate]) {
                            cell.classList.add('holiday'); // 添加特殊样式
                            const tooltip = document.createElement('span');
                            tooltip.textContent = holidays[currentDate];
                            tooltip.classList.add('tooltip');
                            cell.appendChild(tooltip);
                        }

                        cell.appendChild(link);
                        row.appendChild(cell);
                        date++;
                    }
                }
                calendarBody.appendChild(row);
            }
        }

        function updateCalendar() {
            const monthSelect = document.getElementById('monthSelect');
            const selectedMonth = parseInt(monthSelect.value);
            generateCalendar(2025, selectedMonth);
        }

        // 初始化显示1月的日历
        generateCalendar(2025, 0);
    </script>

    <div class="chat-container">
        <h2>大木头不在的话，大木头的替身会像大木头一样回答雅雅～</h2>
        <div id="chatBox"></div>
        <input type="text" id="userInput" placeholder="请输入你的问题..." class="chat-input">
        <button onclick="sendMessage()" class="chat-button">发送</button>
    </div>

    <script>
        let contextMessages = []; // 用于存储对话上下文
        // 为输入框添加键盘事件监听器
        document.getElementById('userInput').addEventListener('keydown', function (event) {
            if (event.key === 'Enter') {
                sendMessage(); // 调用发送函数
            }
        });
        // 发送消息函数
        async function sendMessage() {
            const userInput = document.getElementById('userInput').value;
            const chatBox = document.getElementById('chatBox');

            if (!userInput) {
                return; // 防止发送空消息
            }

            // 显示用户消息
            const userMessage = document.createElement('div');
            userMessage.className = 'chat-box user-box';
            userMessage.innerHTML = `
                <img src="images/index/yaya.jpg" alt="雅雅头像" class="chat-avatar">
                <div class="chat-message">雅雅：${userInput}</div>
            `;
            chatBox.appendChild(userMessage);

            // 清空输入框
            document.getElementById('userInput').value = '';

            // 添加 Bot 回答占位框
            const botMessage = document.createElement('div');
            botMessage.className = 'chat-box bot-box';
            botMessage.innerHTML = `
                <img src="images/index/wood.jpg" alt="大木头头像" class="chat-avatar">
                <div class="chat-message">大木头：正在思考中...</div>
            `;
            chatBox.appendChild(botMessage);

            try {
                const accessToken = "24.de1c5db047606148860fe5a23b54b53b.2592000.1737745563.282335-116844271"; // 替换为实际的 Access Token
                const url = `https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions?access_token=${accessToken}`;

                const payload = {
                    model: "ernie-4.0-turbo-8k",
                    messages: contextMessages.concat([{ role: "user", content: userInput }]),
                    stream: true,
                    system: "你是一个名叫“大木头”的男朋友。你充满爱心、幽默感，对你的女朋友“雅雅”关怀备至，常常用温暖、亲切的语气与她交流，你能够尽可能详细地回答雅雅的任何问题，像聊天一样自然流畅。但你现在正在加州大学伯克利分校交流学习，与“雅雅”远隔重洋，你们彼此很思念对方。"
                };

                const response = await fetch(url, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(payload)
                });

                if (!response.body) {
                    throw new Error("流式响应失败");
                }

                const reader = response.body.getReader();
                const decoder = new TextDecoder("utf-8");
                let partialResult = "";

                while (true) {
                    const { done, value } = await reader.read();
                    if (done) break;

                    const chunk = decoder.decode(value, { stream: true });
                    const lines = chunk.split("\n").filter(line => line.startsWith("data:"));

                    for (const line of lines) {
                        try {
                            const json = JSON.parse(line.slice(5).trim());
                            partialResult += json.result;
                            botMessage.querySelector('.chat-message').textContent = `大木头：${partialResult}`;
                        } catch (e) {
                            console.error("解析错误：", e, line);
                        }
                    }
                }

                // 更新上下文消息
                contextMessages.push(
                    { role: "user", content: userInput },
                    { role: "assistant", content: partialResult }
                );

                // 保留最近10条对话
                if (contextMessages.length > 10) {
                    contextMessages = contextMessages.slice(-10);
                }
            } catch (error) {
                botMessage.querySelector('.chat-message').textContent = '出错了，请稍后再试。';
            }
        }
    </script>

    <div class="footer">
        <p>© 2025 eureka-ya.xin. All rights reserved.</p>
        <p>Designed with ❤️ by 大木头</p>
        <p>网站访问次数：<span id="visitCount"></span></p>
    </div>

    <script>
        let visitCount = localStorage.getItem('visitCount') || 0;
        visitCount++;
        localStorage.setItem('visitCount', visitCount);
        document.getElementById('visitCount').textContent = visitCount;
    </script>
</body>
</html>